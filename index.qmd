---
title: Using diagnostic <br/> classification models
subtitle: to Improve Instructional Decision-Making
author: W. Jake Thompson, Ph.D.
format:
  measr-slides-revealjs:
    progress: false
knitr:
  opts_chunk: 
    comment: "#>"
    fig.width: 7
    fig.asp: 0.618
    fig.align: "center"
freeze: true
code-link: true
preload-iframes: true
code-annotations: select
filters:
  - lua/output-line-highlight.lua
---

## Who am I?

```{r setup}
library(tidyverse)
library(ggmeasr)
library(knitr)
library(measr)
library(here)
library(ggdist)
library(magick)
library(gt)
library(gtExtras)

set_theme(plot_margin = margin(5, 0, 0, 0))
```

:::{.columns}
:::{.column width="50%"}
W. Jake Thompson, Ph.D.

* Assistant Director of Psychometrics
  * [ATLAS](https://atlas.ku.edu) | University of Kansas

* Research: Applications of diagnostic psychometric models
  * Lead psychometrician and Co-PI for the [Dynamic Learnings Maps](https://dynamiclearningmaps.org) assessments
  * PI for an [IES-funded](https://ies.ed.gov/funding/grantsearch/details.asp?ID=4546) project to develop software for diagnostic models
:::

:::{.column width="50%"}
:::{.center}

```{r}
#| label: profile-picture
#| out-width: 50%
#| fig-alt: |
#|   Profile picture for Jake Thompson.

include_graphics("figure/wjt-2022-hex.png")
```

:::{.small}
{{< iconify fa6-brands github >}} &nbsp; [@wjakethompson](https://www.gitub.com/wjakethompson)  
{{< iconify fa6-solid globe >}} &nbsp; [wjakethompson.com](https://wjakethompson.com)
:::
:::
:::
:::

## Acknowledgements

The research reported here was supported by the Institute of Education Sciences, U.S. Department of Education, through Grants [R305D210045](https://ies.ed.gov/funding/grantsearch/details.asp?ID=4546) and [R305D240032](https://ies.ed.gov/funding/grantsearch/details.asp?ID=6075) to the University of Kansas Center for Research, Inc., ATLAS. The opinions expressed are those of the authors and do not represent the views of the the Institute or the U.S. Department of Education. <br><br>

:::{.columns}
:::{.column width="15%"}
:::

:::{.column width="70%"}

```{r}
#| label: ies-logo
#| out-width: 100%
#| fig-align: center
#| fig-alt: |
#|   Logo for the Institute of Education Sciences.

include_graphics("figure/IES_InstituteOfEducationSciences_RGB.png")
```

:::

:::{.column width="15%"}
:::
:::

# What are diagnostic models?

## {.empty background-color="#FFFFFF" data-menu-title="Our Example"}

```{r}
#| label: all-taylor
#| out-width: 100%
#| fit-alt: |
#|   Artistic renderings of Taylor Swift from all 15 album releases.

include_graphics(here("figure", "taylor", "all-taylor.png"))
```

## {data-menu-title="Classic psychometrics"}

:::{.columns}
:::{.column width="25%"}
* Traditional assessments and psychometric models measure an overall skill or ability
* Assume a continuous latent trait
:::

:::{.column width="75%"}
```{r}
#| label: taylor-continuum
#| out-width: 100%
#| out-height: 90%
#| fig-alt: |
#|   A normal distribution with images of Taylor Swift from each era overlayed.

taylors <- read_rds(here("data", "taylor-results.rds")) |>
  mutate(x = theta, y = 0.02, img = here("figure", "taylor", "eras", img))

base <- prior(normal(0, 1), type = "intercept") |>
  dcmstan::prior_tibble() |>
  parse_dist(prior) |>
  ggplot(aes(xdist = .dist_obj)) +
  stat_slab(color = palette_measr[1], fill = palette_measr[3])

width <- 0.6
for (i in 1:nrow(taylors)) {
  img <- as.raster(image_read(taylors$img[i]))

  base <- base +
    annotation_raster(
      img,
      taylors$x[i] - (width / 2),
      taylors$x[i] + (width / 2),
      taylors$y[i],
      taylors$y[i] + 0.25
    )
}

base +
  labs(x = "Musical Knowledge", y = NULL) +
  theme(axis.text.y = element_blank(), axis.title.y = element_blank())
```

:::
:::

## {data-menu-title="Traditional measurement: Weak ordering"}

:::{.columns}
:::{.column width="25%"}
* The output is a weak ordering due to error in estimates
  * Confident *Taylor Swift* (debut) is the worst
  * Not confident on ordering toward the middle of the distribution
:::

:::{.column width="75%"}
```{r}
#| label: taylor-continuum
#| out-width: 100%
#| out-height: 90%
#| fig-alt: |
#|   A normal distribution with images of Taylor Swift from each era overlayed.
```

:::
:::

## {data-menu-title="Traditional measurement: Student feedback"}

:::{.columns}
:::{.column width="25%"}
* Limited in the types of questions that can be answered. 
  * Why is *Taylor Swift* (debut) so low?
  * What aspects do each era demonstrate proficiency or competency of?
  * How much skill is "enough" to be competent?
:::

:::{.column width="75%"}
```{r}
#| label: taylor-continuum
#| out-width: 100%
#| out-height: 90%
#| fig-alt: |
#|   A normal distribution with images of Taylor Swift from each era overlayed.
```

:::
:::
  
## Diagnostic measurement

* Designed to be multidimensional
* No continuum of student achievement
* Categorical constructs
  * Usually binary (e.g., master/nonmaster, proficient/not proficient)

* Several different names in the literature
  * Diagnostic classification models (DCMs)
  * Cognitive diagnostic models (CDMs)
  * Skills assessment models
  * Latent response models
  * Restricted latent class models

## Diagnostic music assessment

:::{.columns}

:::{.column width="30%"}
* Rather than measuring overall musical knowledge, we can break music down into set of skills or *attributes*
  * Songwriting
  * Production
  * Vocals
:::

:::{.column width="70%"}
```{r}
#| label: music-attributes
#| fig-asp: 0.3
#| out-width: 80%
#| out-height: 40%
#| fig-alt: |
#|   Three circles representing the 3 attributes. The bottom half of each circle
#|   is shaded dark, and the top half is light, to indicate there are two
#|   categories for each attribute.

library(ggforce)

tibble(
  start = rep(c(-pi / 2, pi / 2), 3),
  type = rep(c("Proficient", "Non-proficient"), 3),
  skill = rep(c("Songwriting", "Production", "Vocals"), each = 2),
  x = rep(c(3, 6, 9), each = 2),
  y = 0
) |>
  ggplot() +
  geom_arc_bar(
    aes(
      x0 = x,
      y0 = y,
      r0 = 0,
      r = 1.2,
      start = start,
      end = start + pi,
      fill = type
    ),
    color = "white",
    show.legend = FALSE,
    radius = 0
  ) +
  geom_text(
    data = ~ slice(., c(1, 3, 5, 7)),
    aes(x = x, y = 0.2, label = skill),
    size = 5
  ) +
  scale_fill_manual(
    values = c(
      "Proficient" = palette_measr[3],
      "Non-proficient" = palette_measr[1]
    )
  ) +
  coord_equal() +
  theme_void()
```

:::
:::

* Attributes are categorical, often dichotomous (e.g., proficient vs. non-proficient)

## Diagnostic classification models

:::{.columns}
:::{.column width="50%"}
* DCMs place individuals into groups according to proficiency of multiple attributes
:::

:::{.column width="50%"}
```{r}
#| label: taylor-profiles

library(gt)
library(gtExtras)

taylor_profiles <- taylors |>
  mutate(across(c(songwriting, production, vocals), \(x) {
    case_when(x == 1 ~ "check", x == 0 ~ "xmark")
  })) |>
  mutate(
    s_color = case_when(
      songwriting == "xmark" ~ palette_measr[2],
      songwriting == "check" ~ palette_measr[4]
    ),
    p_color = case_when(
      production == "xmark" ~ palette_measr[2],
      production == "check" ~ palette_measr[4]
    ),
    v_color = case_when(
      vocals == "xmark" ~ palette_measr[2],
      vocals == "check" ~ palette_measr[4]
    )
  ) |>
  select(
    era,
    album_release,
    img,
    songwriting,
    production,
    vocals,
    ends_with("_color")
  )

taylor_profiles |>
  filter(era %in% c("Debut", "1989", "reputation", "folklore")) |>
  select(img, songwriting, production, vocals, ends_with("_color")) |>
  gt() |>
  cols_hide(ends_with("_color")) |>
  cols_label(img = "") |>
  # cols_width(img ~ px(100),
  #            everything() ~ px(150)) |>
  gt_img_rows(columns = img, img_source = "local", height = 75) |>
  fmt_icon(songwriting, fill_color = from_column("s_color"), height = "40px") |>
  fmt_icon(production, fill_color = from_column("p_color"), height = "40px") |>
  fmt_icon(vocals, fill_color = from_column("v_color"), height = "40px") |>
  cols_align("center", -img) |>
  gt_theme_measr() |>
  tab_options(table.font.size = 24)
```

:::
:::

## Benefits of DCMs

:::{.columns}
:::{.column width="50%"}
* Fine-grained, multidimensional results. Answer more questions:
  * Why is *Taylor Swift* (debut) so low?
    * Subpar songwriting, production, and vocals
  * What aspects are albums competent/proficient in?
    * DCMs provide classifications directly

* High reliability with fewer items
  * Less information need to classify than to place precisely along a scale
:::

:::{.column width="50%"}
```{r}
#| label: taylor-profiles
```

:::
:::

# Using DCMs to improve student<br/>outcomes

## Applications in educational assessment

:::{.columns}

:::{.column width="57%"}
* [Dynamic Learning Maps&reg;](https://dynamiclearningmaps.org)
  * Achievement assessment for students with the most significant cognitive disabilities
  * Currently used by 24 states for accountability reporting to the U.S. Department of Education

* [Pathways to Instructionally Embedded assessment](https://pie.atlas4learning.org)
  * Competitive Grant for State Assessment award from the U.S. Department of Education
  * Partnership between ATLAS and the Missouri Department of Elementary and Secondary Education
:::

:::{.column width="3%"}
:::

:::{.column .center width="40%"}

```{r}
#| label: emip-qr-code
#| out-width: 80%
#| fig-alt: |
#|   QR code linking to https://doi.org/10.1111/emip.12619

include_graphics("figure/qr-emip.png")
```

:::{.smaller}
[Thompson & Clark (2024)](https://doi.org/10.1111/emip.12619): *Improving instructional decision-making using diagnostic classification models*
:::
:::

:::

## Dynamic Learning Maps (DLM)

* Assessment items are aligned to alternate academic achievement standards
  * Academic content available at multiple levels of complexity for each standard
  * Results reported as profile of skills mastered within each standard

* Teachers have flexibility to assign the level most appropriate for their student

* Skills within each standard follow a linear hierarchy

* Results are used throughout the year to inform individual education program (IEP) plans and instructional planning ([Clark et al., 2023](https://doi.org/10.7275/pare.1255))

## DLM reporting {.empty-white}

```{r}
#| label: dlm-isr
#| fig-alt: >
#|   A section of the Learning Profile from a DLM score report.

include_graphics("figure/dlm-isr.png")
```

## Pathways to Instructionally Embedded assessment (PIE)

* Pathway levels were developed for grade 5 mathematics to identify precursor concepts and skills related to the learning target of each standard

* Students are assessed on each pathway level within the standard over the course of an instructional cycle
  * Baseline: Level 1
  * Midway: Level 1 (retest) + Level 2
  * End-of-unit: Level 2 (retest) + Level 3

* Teachers can use results to implement small group or individualized instructional strategies ([ATLAS, 2025](https://pie.atlas4learning.org/sites/default/files/documents/resources/Educator_Perspectives_on_the_PIE_Assessment_System-Evidence_from_a_Pilot_Study.pdf))

## PIE instructional cycle {.empty-white}

```{r}
#| label: pie-cycle
#| fig-alt: >
#|   The PIE cycle of instruction, assessment, and evaluation.

include_graphics("figure/pie-cycle.jpg")
```

## PIE reporting {.empty-white}

```{r}
#| label: pie-student
#| fig-alt: >
#|   A screenshot of the PIE student dashboard.

include_graphics("figure/pie-student.png")
```

## PIE reporting {.empty-white}

```{r}
#| label: pie-class
#| fig-alt: >
#|   A screenshot of the PIE classroom dashboard.

include_graphics("figure/pie-class.png")
```

## Additional research applications

* Evaluate educator understanding of concepts to inform professional development opportunities (e.g., [Bradshaw et al., 2014](https://doi.org/10.1111/emip.12020), [Izs√°k et al., 2019](https://doi.org/10.5951/jresematheduc.50.2.0156))

* Understand profiles of mental health symptoms (e.g., [Tan et al., 2023](https://doi.org/10.1007/s11121-022-01346-8))

* Evaluate the effect of interventions as transitions in proficiency status (e.g., [Madison & Bradshaw, 2018](https://doi.org/10.1111/jedm.12162))

* How to get started...

# {.empty data-menu-title="measr" background-color="#023047" background-iframe="grid-worms/index.html"}

```{r}
#| label: big-image
#| out-width: 100%
#| fig-alt: "Hex logo for the measr R package."

include_graphics("figure/measr-hex.png")
```

## Improved software for diagnostic models {.flip-brand}

* measr: [R](https://r-project.org) package for Bayesian psychometric measurement using [*Stan*](https://mc-stan.org)

* Easily specify and estimate a DCM
  * Wide variety of DCMs (e.g., LCDM, DINA, C-RUM)
  * Defined attribute relationships and dependencies
  * Supports maximum likelihood and full MCMC model estimation

* Powerful model evaluation tools
  * Model fit using posterior predictive model checks
  * Model comparisons with leave-one-out cross validation
  * Classification accuracy and consistency metrics

More information: <https://measr.r-dcm.org>

# Thank you! {.thank-you data-menu-title="Get in touch" background-color="#023047"}

:::{.columns .v-center-container}

:::{.column .image width="65%"}

:::{.center}
Slides
:::

```{r}
#| label: slides-qr-code
#| out-width: 50%
#| fig-alt: |
#|   QR code linking to https://iice2026.wjakethompson.com.

include_graphics("figure/qr-slides.png")
```

:::

:::{.column width="35%"}

:::{.thank-you-subtitle}

:::{.small}

{{< iconify fa6-solid globe >}} \ [wjakethompson.com](https://wjakethompson.com)  
{{< iconify fa6-solid envelope >}} \ [wjakethompson@ku.edu](mailto:wjakethompson@ku.edu)  
{{< iconify fa6-brands orcid >}} \ [0000-0001-7339-0300](https://orcid.org/0000-0001-7339-0300)  
{{< iconify fa6-brands linkedin >}} \ [in/wjakethompson](https://linkedin.com/in/wjakethompson)  
{{< iconify fa6-brands github >}} \ [@wjakethompson](https://github.com/wjakethompson)  
{{< iconify fa6-brands mastodon >}} \ [@wjakethompson@fosstodon.org](https://fosstodon.org/@wjakethompson)  
{{< iconify fa6-brands bluesky >}} \ [@wjakethompson.com](https://bsky.app/profile/wjakethompson.com)  
{{< iconify fa6-brands threads >}} \ [@wjakethompson](https://www.threads.net/@wjakethompson)  
{{< iconify fa6-brands x-twitter >}} \ [@wjakethompson](https://twitter.com/wjakethompson)  

:::

:::

:::

:::
